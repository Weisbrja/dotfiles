#!/bin/sh

filename=$(dmenu -l 0 -p 'Filename' <&-)

audio_monitor=$(pactl list sources short | grep 'monitor' | awk '{ print $2 }' | dmenu -p 'Audio monitor')

screen_resolution=$(xrandr -q --current | grep '*' | awk '{ print $1 }' | head -n 1)

ffmpeg -loglevel error \
	-f pulse -i default -ac 2 \
	-f pulse -i "$audio_monitor" -ac 2 \
	-f x11grab -r 30 -s "$screen_resolution" -i :0.0 -vcodec libx264 \
	"$filename"
